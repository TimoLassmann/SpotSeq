#+TITLE:  testing 
#+AUTHOR: Timo Lassmann
#+EMAIL:  timo.lassmann@telethonkids.org.au
#+DATE:   2018-08-20
#+LATEX_CLASS: report
#+OPTIONS:  toc:nil
#+OPTIONS: H:4
#+LATEX_CMD: xelatex

* Introduction 
  

#+BEGIN_SRC R :session one :results none
library(reshape2)
library(ggplot2)
dat = read.csv("test.csv",header= TRUE, row.names= 1)


#+END_SRC

#+BEGIN_SRC R :session one :output graphics :file hist.jpg
sum = colSums(dat);

plot(sum)

#+END_SRC

#+RESULTS:
[[file:hist.jpg]]

Melt and plot

#+BEGIN_SRC R :session one 

max_count = max(dat)
min_count = min(dat)
x = melt(t(dat[,sum > 50]))
head(x)

#+END_SRC

#+RESULTS:
| State2 | 0 |  0 |
| State3 | 0 |  0 |
| State4 | 0 |  0 |
| State5 | 0 | 48 |
| State6 | 0 |  0 |
| State7 | 0 |  0 |

#+BEGIN_SRC R :session one

  cols <- c(colorRampPalette(c("white", "cornflowerblue"))(10),
            colorRampPalette(c("yellow", "red"))(30))

  ggplot(x, aes(y=Var1, x=Var2, fill=value)) + 
    geom_tile(colour="white", linewidth=2, 
              width=.9, height=.9) + theme_minimal() +
      scale_fill_gradientn(colours=cols, limits=c(min_count, max_count),
                          breaks=seq(min_count, maxcount, by=1), 
                          na.value=rgb(246, 246, 246, max=255),
                          guide=guide_colourbar(ticks=T, nbin=10,
                                 barheight=2, label=T, 
                                 barwidth=2)) 
#+END_SRC  

#+RESULTS:



* plotting LOGOs 

#+BEGIN_SRC R :session one 
library(ggplot2)
library(gglogo)
library(gridextra)
data(sequences)
ggplot(data = ggfortify(sequences, "peptide")) +      
  geom_logo(aes(x=position, y=bits, group=element, 
     label=element, fill=interaction(Polarity, Water)),
     alpha = 0.6)  +
  scale_fill_brewer(palette="Paired") +
  theme(legend.position = "bottom")
#+END_SRC

#+RESULTS:

* Meeting Notes




